<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>hellooo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <title>Chat Interface</title>
    <style>
        .chat-container {
            width: 400px;
            height: 500px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: scroll;
        }

        .message {
            background-color: #f1f1f1;
            padding: 10px;
            margin-bottom: 10px;
        }

        .user-message {
            background-color: #dff6f0;
        }

        .bot-message {
            background-color: #f6f6f6;
        }

        .input-container {
            margin-top: 10px;
        }

        .input-container input {
            width: 300px;
            padding: 5px;
        }

        .input-container button {
            padding: 5px 10px;
        }
    </style>
  </head>
  <body>
    <h2>Chat Interface</h2>

    <div class="chat-container" id="chat_message">
        <div class="message bot-message">
            <p>Welcome to the chat!</p>
        </div>
    </div>

    <div class="input-container">
        <input type="text" id="user-input" placeholder="Type your message...">
        <button type="submit" id="send">Send</button>
    </div>

    
    <!-- <script>
      function sendMessage() {
          var userInput = document.getElementById("user-input").value;

          if (userInput.trim() !== "") {
              var messageContainer = document.createElement("div");
              messageContainer.className = "message user-message";

              var messageContent = document.createElement("p");
              messageContent.textContent = userInput;

              messageContainer.appendChild(messageContent);

              document.querySelector(".chat-container").appendChild(messageContainer);
              document.getElementById("user-input").value = "";
          }
      }
  </script> -->

    
    {{room_name|json_script:"room-name"}}
    

    <script>
        document.querySelector('#send').onclick= function(e){
          const messageInputDom= document.querySelector('#user-input');
          const message = messageInputDom.value;
          chatSocket.send(JSON.stringify({
            'message':message
          }));

          messageInputDom.value='';

        }
        
        const roomName = JSON.parse(document.getElementById('room-name').textContent);
        const chatSocket = new WebSocket(
            'wss://'+
             window.location.host +
            '/wss/chat/' +
            roomName +
            '/'
            
        );

        chatSocket.onmessage = function(e){
            const data = JSON.parse(e.data);
            console.log(data)
            document.querySelector('#chat_message').vlaue+=(data.message + '\n')
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  </body>
</html>